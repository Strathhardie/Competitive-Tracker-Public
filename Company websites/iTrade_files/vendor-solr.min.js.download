var Manager;function showResultsPanel(e,t){$(t.searchResult).show(),$("#content").hide(),$(t.main).hide()}function clearSearch(e){$(e.searchResult).hide(),$("#content").show(),$(e.main).show()}function addHistory(e,t,a){var r=void 0===window.location.search?window.location.search:"?search",n="#"+$.trim(e).replace(/\s+/g,"-").toLowerCase();a&&(r=r+"&page="+a),window.history.pushState(null,t,r+n)}function getParameterByName(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null}console.log("Solr Search mobile managers"),function(e){e(function(){window.location.hash.replace(/-/g," ").replace(/#/g,""),window.location.search.indexOf("search"),window.location.search.indexOf("page");var t=e("[name='source']").val();if(void 0!==t)t.substring(3,5)}),e.fn.showIf=function(e){return e?this.show():this.hide()}}(jQuery),AjaxSolr=function(){},AjaxSolr.Class=function(e){AjaxSolr.extend(this,e)},AjaxSolr.Class.extend=function(e,t){var a,r=this;a=e&&Object.prototype.hasOwnProperty.call(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},AjaxSolr.extend(a,r,t);var n=function(){this.constructor=a};return n.prototype=r.prototype,a.prototype=new n,e&&AjaxSolr.extend(a.prototype,e),a.__super__=r.prototype,a},AjaxSolr.extend=function(e){var t=Array.prototype.slice.call(arguments,1),a=function(t){if(t)for(var a in t)e[a]=t[a]};if(null!=t){if(Array.prototype.forEach&&t.forEach===Array.prototype.forEach)t.forEach(a);else if(t.length===+t.length)for(var r=0,n=t.length;r<n;r++)a.call(void 0,t[r],r,t);else for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&a.call(void 0,t[s],s,t);return e}},AjaxSolr.inArray=function(e,t){if(t)for(var a=0,r=t.length;a<r;a++)if(AjaxSolr.equals(t[a],e))return a;return-1},AjaxSolr.equals=function(e,t){if(AjaxSolr.isArray(e)&&AjaxSolr.isArray(t)){if(e.length!==t.length)return!1;for(var a=0,r=e.length;a<r;a++)if(e[a]!==t[a])return!1;return!0}return AjaxSolr.isRegExp(e)&&AjaxSolr.isString(t)?t.match(e):AjaxSolr.isRegExp(t)&&AjaxSolr.isString(e)?e.match(t):e===t},AjaxSolr.isArray=function(e){return null!=e&&"object"==typeof e&&"splice"in e&&"join"in e},AjaxSolr.isRegExp=function(e){return null!=e&&("object"==typeof e||"function"==typeof e)&&"ignoreCase"in e},AjaxSolr.isString=function(e){return null!=e&&"string"==typeof e},function(e){"function"==typeof define&&define.amd?define(["core/Core"],e):e()}(function(){AjaxSolr.AbstractManager=AjaxSolr.Class.extend({constructor:function(e){AjaxSolr.extend(this,{solrUrl:"http://localhost:8983/solr/",proxyUrl:null,servlet:"select",response:{},widgets:{},store:null,initialized:!1},e)},init:function(){for(var e in this.initialized=!0,null===this.store&&this.setStore(new AjaxSolr.ParameterStore),this.store.load(!1),this.widgets)this.widgets[e].init();this.store.init()},setStore:function(e){e.manager=this,this.store=e},addWidget:function(e){e.manager=this,this.widgets[e.id]=e},doRequest:function(e,t){for(var a in!1===this.initialized&&this.init(),void 0!==e&&this.store.get("start").val(e),void 0===t&&(t=this.servlet),this.store.save(),this.widgets)this.widgets[a].beforeRequest();this.executeRequest(t)},executeRequest:function(e,t){throw"Abstract method executeRequest must be overridden in a subclass."},handleResponse:function(e){for(var t in this.response=e,this.widgets)this.widgets[t].afterRequest()},handleError:function(e){window.console&&console.log&&console.log(e)}})}),function(e){"function"==typeof define&&define.amd?define(["core/AbstractManager"],e):e()}(function(){AjaxSolr.Manager=AjaxSolr.AbstractManager.extend({executeRequest:function(e,t,a,r){var n,s=this,i={dataType:"json"};t=t||this.store.string(),a=a||function(e){s.handleResponse(e)},r=r||function(e,t,a){s.handleError(t+", "+a)},this.proxyUrl?(i.url=this.proxyUrl,i.data={query:t},i.type="POST"):(n="fq=main:[* TO *] AND title:[* TO *]",i.url=this.solrUrl+e+"?"+t+"&fl=id,title,contentLength_l&"+n+"&wt=json&json.wrf=?"),jQuery.ajax(i).done(a).fail(r)},reset:function(e){this.store.addByValue("spellcheck.q",e),this.store.addByValue("hl.q",e),this.store.addByValue("q",e),this.store.addByValue("spellcheck","true"),this.store.addByValue("start","0")}})}),function(e){"function"==typeof define&&define.amd?define(["core/Core"],e):e()}(function(){AjaxSolr.Parameter=AjaxSolr.Class.extend({constructor:function(e){AjaxSolr.extend(this,{name:null,value:null,locals:{}},e)},val:function(e){if(void 0===e)return this.value;this.value=e},local:function(e,t){if(void 0===t)return this.locals[e];this.locals[e]=t},remove:function(e){delete this.locals[e]},string:function(){var e=[];for(var t in this.locals)this.locals[t]&&e.push(t+"="+encodeURIComponent(this.locals[t]));var a=e.length?"{!"+e.join("%20")+"}":"";return this.value?this.name+"="+a+this.valueString(this.value):"q"==this.name&&a?"q.alt="+a+encodeURIComponent("*:*"):""},parseString:function(e){var t=e.match(/^([^=]+)=(?:\{!([^\}]*)\})?(.*)$/);if(t){for(var a;a=/([^\s=]+)=(\S*)/g.exec(decodeURIComponent(t[2]));)this.locals[a[1]]=decodeURIComponent(a[2]),t[2]=t[2].replace(a[0],"");"q.alt"==t[1]?this.name="q":(this.name=t[1],this.value=this.parseValueString(t[3]))}},valueString:function(e){return e=AjaxSolr.isArray(e)?e.join(","):e,encodeURIComponent(e)},parseValueString:function(e){return-1==(e=decodeURIComponent(e)).indexOf(",")?e:e.split(",")}}),AjaxSolr.Parameter.escapeValue=function(e){return!e.match(/[ :\/"]/)||e.match(/[\[\{]\S+ TO \S+[\]\}]/)||e.match(/^["\(].*["\)]$/)?e:'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'}}),function(e){"function"==typeof define&&define.amd?define(["core/Core","core/Parameter"],e):e()}(function(){AjaxSolr.ParameterStore=AjaxSolr.Class.extend({constructor:function(e){AjaxSolr.extend(this,{exposed:[],params:{},manager:null},e)},init:function(){},isMultiple:function(e){return e.match(/^(?:bf|bq|facet\.date|facet\.date\.other|facet\.date\.include|facet\.field|facet\.pivot|facet\.range|facet\.range\.other|facet\.range\.include|facet\.query|fq|group\.field|group\.func|group\.query|pf|qf)$/)},get:function(e){if(void 0===this.params[e]){var t=new AjaxSolr.Parameter({name:e});this.isMultiple(e)?this.params[e]=[t]:this.params[e]=t}return this.params[e]},values:function(e){if(void 0!==this.params[e]){if(this.isMultiple(e)){for(var t=[],a=0,r=this.params[e].length;a<r;a++)t.push(this.params[e][a].val());return t}return[this.params[e].val()]}return[]},add:function(e,t){if(void 0===t&&(t=new AjaxSolr.Parameter({name:e})),this.isMultiple(e))if(void 0===this.params[e])this.params[e]=[t];else{if(-1!=AjaxSolr.inArray(t.val(),this.values(e)))return!1;this.params[e].push(t)}else this.params[e]=t;return t},remove:function(e,t){void 0===t?delete this.params[e]:(this.params[e].splice(t,1),0==this.params[e].length&&delete this.params[e])},find:function(e,t){if(void 0!==this.params[e]){if(this.isMultiple(e)){for(var a=[],r=0,n=this.params[e].length;r<n;r++)AjaxSolr.equals(this.params[e][r].val(),t)&&a.push(r);return!!a.length&&a}if(AjaxSolr.equals(this.params[e].val(),t))return e}return!1},addByValue:function(e,t,a){if(void 0===a&&(a={}),this.isMultiple(e)&&AjaxSolr.isArray(t)){for(var r=[],n=0,s=t.length;n<s;n++)r.push(this.add(e,new AjaxSolr.Parameter({name:e,value:t[n],locals:a})));return r}return this.add(e,new AjaxSolr.Parameter({name:e,value:t,locals:a}))},removeByValue:function(e,t){var a=this.find(e,t);if(a)if(AjaxSolr.isArray(a))for(var r=a.length-1;r>=0;r--)this.remove(e,a[r]);else this.remove(a);return a},string:function(){var e,t=[];for(var a in this.params)if(this.isMultiple(a))for(var r=0,n=this.params[a].length;r<n;r++)(e=this.params[a][r].string())&&t.push(e);else(e=this.params[a].string())&&t.push(e);return t.join("&")},parseString:function(e){for(var t=e.split("&"),a=0,r=t.length;a<r;a++)if(t[a]){var n=new AjaxSolr.Parameter;n.parseString(t[a]),this.add(n.name,n)}},exposedString:function(){for(var e,t=[],a=0,r=this.exposed.length;a<r;a++)if(void 0!==this.params[this.exposed[a]])if(this.isMultiple(this.exposed[a]))for(var n=0,s=this.params[this.exposed[a]].length;n<s;n++)(e=this.params[this.exposed[a]][n].string())&&t.push(e);else(e=this.params[this.exposed[a]].string())&&t.push(e);return t.join("&")},exposedReset:function(){for(var e=0,t=this.exposed.length;e<t;e++)this.remove(this.exposed[e])},load:function(e){void 0===e&&(e=!0),e&&this.exposedReset(),this.parseString(this.storedString())},save:function(){},storedString:function(){return""}})}),function(e){"function"==typeof define&&define.amd?define(["core/Core"],e):e()}(function(){AjaxSolr.AbstractWidget=AjaxSolr.Class.extend({constructor:function(e){AjaxSolr.extend(this,{id:null,target:null,start:void 0,servlet:void 0,manager:null},e)},init:function(){},beforeRequest:function(){},afterRequest:function(){},doRequest:function(e,t){this.manager.doRequest(e||this.start,t||this.servlet)}})}),function(e){const t="search--loading";AjaxSolr.ResultWidget=AjaxSolr.AbstractWidget.extend({start:0,constructor:function(e){AjaxSolr.extend(this,{header:"",tail:"",ques:"",summarytarget:null,summarypager:null,suggestiontarget:null},e)},beforeRequest:function(){e(document.body).addClass(t)},afterRequest:function(){e(this.target).empty(),e(this.suggestiontarget).empty(),e(this.summarytarget).empty(),e(this.summarypager).empty();for(var t=this.manager.response.response.start,a=this.manager.response.highlighting,r=this.manager.response.response.docs.length,n=0;n<r;n++){var s=this.manager.response.response.docs[n];e(this.target).append(this.template(s,a,t+n+1))}var i=this.manager.store.params.q.value;r>=1?(i=this.header+"<strong><span class='norm'>"+i+"</span></strong>"+this.tail,e(this.summarytarget).append(i)):e(this.summarytarget).append(this.notFound+"<b>"+this.suggestions(this.manager.response.spellcheck.suggestions)+"</b>")},suggestions:function(e){var t="";if(void 0==e||e.length<1)return"";for(var a=e[1].suggestion,r=0,n=a.length;r<n;r++)t=t+" <a> "+a[r]+" </a> ";return this.ques+t+"?"},template:function(e,t,a){var r="";function n(e,t){var a=e;a.replace(/<?strong>/g,"").length>t&&(a=(a=a.substring(0,t)).replace(/^(.*)\s[A-Z].*?$/,"$1"),a+=" ..."),r+='<p class="i--summary">'+a+"</p>"}var s=t[e.id],i=(Math.round(e.contentLength_l/1e3),'<a href="'+e.id+'"><h5 class="i--title">'+s.title+"</h5></a>");return void 0!==s.main?n(s.main[0],500):n(s.title[0],200),"<article class='sr--item'>"+i+r+"</article>"}})}(jQuery),function(e){"function"==typeof define&&define.amd?define(["core/AbstractWidget"],e):e()}(function(){var e;e=jQuery,AjaxSolr.PagerWidget=AjaxSolr.AbstractWidget.extend({constructor:function(e){AjaxSolr.extend(this,{innerWindow:4,outerWindow:1,prevLabel:"&laquo; Previous",nextLabel:"Next &raquo;",separator:" ",currentPage:null,totalPages:null},e)},gapMarker:function(){return'<span class="pager-gap">&hellip;</span>'},windowedLinks:function(){var e=[],t=null;visible=this.visiblePageNumbers();for(var a=0,r=visible.length;a<r;a++)t&&visible[a]>t+1&&e.push(this.gapMarker()),e.push(this.pageLinkOrSpan(visible[a],["pager-current"])),t=visible[a];return e},visiblePageNumbers:function(){var e=this.currentPage-this.innerWindow,t=this.currentPage+this.innerWindow;t>this.totalPages&&(e=Math.max(0,e-(t-this.totalPages)),t=this.totalPages),e<1&&(t=Math.min(this.totalPages,t+(1-e)),e=1);var a=[];a.push(1);for(var r=2;r<=Math.min(1+this.outerWindow,e-1);r++)a.push(r);for(1+this.outerWindow==e-2&&a.push(e-1),r=Math.max(2,e);r<=Math.min(t,this.totalPages-1);r++)a.push(r);for(this.totalPages-this.outerWindow==t+2&&a.push(t+1),r=Math.max(this.totalPages-this.outerWindow,t+1);r<this.totalPages;r++)a.push(r);return this.totalPages>1&&a.push(this.totalPages),a},pageLinkOrSpan:function(t,a,r){return r=r||t,t&&t!=this.currentPage?e('<a href="?search&page='+r+window.location.hash+'"></a>').html(r).attr("rel",this.relValue(t)).addClass(a[1]).click(this.clickHandler(t)):e("<span></span>").html(r).addClass(a.join(" "))},clickHandler:function(e){var t=this;return function(){return window.history.pushState(null,null,"?search&page="+e+window.location.hash),t.manager.store.get("start").val((e-1)*t.perPage()),t.doRequest(),!1}},relValue:function(e){switch(e){case this.previousPage():return"prev"+(1==e?"start":"");case this.nextPage():return"next";case 1:return"start";default:return""}},previousPage:function(){return this.currentPage>1?this.currentPage-1:null},nextPage:function(){return this.currentPage<this.totalPages?this.currentPage+1:null},renderHeader:function(e,t,a){},hashLoad:function(e){this.manager.store.get("start").val((e-1)*this.perPage())},renderLinks:function(t){if(this.totalPages>1){t.unshift(this.pageLinkOrSpan(this.previousPage(),["pager-disabled","pager-prev"],this.prevLabel)),t.push(this.pageLinkOrSpan(this.nextPage(),["pager-disabled","pager-next"],this.nextLabel));var a=e(this.target);a.empty();for(var r=0,n=t.length;r<n;r++){var s=e("<li></li>");this.separator&&r>0&&s.append(this.separator),a.append(s.append(t[r]))}}},perPage:function(){return parseInt(this.manager.response.responseHeader&&this.manager.response.responseHeader.params&&this.manager.response.responseHeader.params.rows||this.manager.store.get("rows").val()||10)},getOffset:function(){return parseInt(this.manager.response.responseHeader&&this.manager.response.responseHeader.params&&this.manager.response.responseHeader.params.start||this.manager.store.get("start").val()||0)},afterRequest:function(){/search/.test(window.location.search)&&(pageNum=getParameterByName("page")||1,this.hashLoad(pageNum));var t=this.perPage(),a=this.getOffset(),r=parseInt(this.manager.response.response.numFound);a-=a%t,this.currentPage=Math.ceil((a+1)/t),this.totalPages=Math.ceil(r/t),e(this.target).empty(),this.renderLinks(this.windowedLinks()),this.renderHeader(t,a,r)}})}),function(e){"function"==typeof define&&define.amd?define(["core/AbstractWidget","core/Parameter"],e):e()}(function(){AjaxSolr.AbstractFacetWidget=AjaxSolr.AbstractWidget.extend({constructor:function(e){AjaxSolr.extend(this,{start:0,field:null,multivalue:!0},e)},init:function(){this.initStore()},initStore:function(){var e=["facet.prefix","facet.sort","facet.limit","facet.offset","facet.mincount","facet.missing","facet.method","facet.enum.cache.minDf"];this.manager.store.addByValue("facet",!0),void 0!==this["facet.field"]?this.manager.store.addByValue("facet.field",this.field):void 0!==this["facet.date"]?(this.manager.store.addByValue("facet.date",this.field),e=e.concat(["facet.date.start","facet.date.end","facet.date.gap","facet.date.hardend","facet.date.other","facet.date.include"])):void 0!==this["facet.range"]&&(this.manager.store.addByValue("facet.range",this.field),e=e.concat(["facet.range.start","facet.range.end","facet.range.gap","facet.range.hardend","facet.range.other","facet.range.include"]));for(var t=0,a=e.length;t<a;t++)void 0!==this[e[t]]&&this.manager.store.addByValue("f."+this.field+"."+e[t],this[e[t]])},isEmpty:function(){return!this.manager.store.find("fq",new RegExp("^-?"+this.field+":"))},set:function(e){return this.changeSelection(function(){var t=this.manager.store.removeByValue("fq",new RegExp("^-?"+this.field+":")),a=this.manager.store.addByValue("fq",this.fq(e));return t||a})},add:function(e){return this.changeSelection(function(){return this.manager.store.addByValue("fq",this.fq(e))})},remove:function(e){return this.changeSelection(function(){return this.manager.store.removeByValue("fq",this.fq(e))})},clear:function(){return this.changeSelection(function(){return this.manager.store.removeByValue("fq",new RegExp("^-?"+this.field+":"))})},changeSelection:function(e){return changed=e.apply(this),changed&&this.afterChangeSelection(),changed},afterChangeSelection:function(){},getFacetCounts:function(){var e;if(void 0!==this["facet.field"]?e="facet_fields":void 0!==this["facet.date"]?e="facet_dates":void 0!==this["facet.range"]&&(e="facet_ranges"),void 0!==e)switch(this.manager.store.get("json.nl").val()){case"map":return this.getFacetCountsMap(e);case"arrarr":return this.getFacetCountsArrarr(e);default:return this.getFacetCountsFlat(e)}throw'Cannot get facet counts unless one of the following properties is set to "true" on widget "'+this.id+'": "facet.field", "facet.date", or "facet.range".'},getFacetCountsMap:function(e){var t=[];for(var a in this.manager.response.facet_counts[e][this.field])t.push({facet:a,count:parseInt(this.manager.response.facet_counts[e][this.field][a])});return t},getFacetCountsArrarr:function(e){for(var t=[],a=0,r=this.manager.response.facet_counts[e][this.field].length;a<r;a++)t.push({facet:this.manager.response.facet_counts[e][this.field][a][0],count:parseInt(this.manager.response.facet_counts[e][this.field][a][1])});return t},getFacetCountsFlat:function(e){for(var t=[],a=0,r=this.manager.response.facet_counts[e][this.field].length;a<r;a+=2)t.push({facet:this.manager.response.facet_counts[e][this.field][a],count:parseInt(this.manager.response.facet_counts[e][this.field][a+1])});return t},clickHandler:function(e){var t=this,a=this.multivalue?"add":"set";return function(){return t[a].call(t,e)&&t.doRequest(),!1}},unclickHandler:function(e){var t=this;return function(){return t.remove(e)&&t.doRequest(),!1}},fq:function(e,t){return(t?"-":"")+this.field+":"+AjaxSolr.Parameter.escapeValue(e)}})}),function(e){"function"==typeof define&&define.amd?define(["core/ParameterStore"],e):e()}(function(){AjaxSolr.ParameterHashStore=AjaxSolr.ParameterStore.extend({constructor:function(e){AjaxSolr.ParameterHashStore.__super__.constructor.apply(this,arguments),AjaxSolr.extend(this,{interval:250,intervalId:null,hash:""},e)},init:function(){this.exposed.length&&("onhashchange"in window&&(!document.documentMode||document.documentMode>7)?window.addEventListener?window.addEventListener("hashchange",this.intervalFunction(this),!1):window.attachEvent?window.attachEvent("onhashchange",this.intervalFunction(this)):window.onhashchange=this.intervalFunction(this):this.intervalId=window.setInterval(this.intervalFunction(this),this.interval))},save:function(){this.hash=this.exposedString(),this.storedString()?window.location.hash=this.hash:window.location.replace(window.location.href.replace("#","")+"#"+this.hash)},storedString:function(){var e=window.location.href.indexOf("#");return-1==e?"":window.location.href.substr(e+1)},intervalFunction:function(e){return function(){var t=e.storedString();e.hash!=t&&decodeURIComponent(e.hash)!=decodeURIComponent(t)&&(e.load(),e.manager.doRequest())}}})}),function(e){"function"==typeof define&&define.amd?define(["core/AbstractWidget"],e):e()}(function(){AjaxSolr.AbstractTextWidget=AjaxSolr.AbstractWidget.extend({constructor:function(e){AjaxSolr.extend(this,{start:0},e)},set:function(e){return this.changeSelection(function(){this.manager.store.get("q").val(e)})},reset:function(e){return this.changeSelection(function(){this.manager.reset(e)})},clear:function(){return this.changeSelection(function(){this.manager.store.remove("q")})},changeSelection:function(e){var t=this.manager.store.get("q").val();e.apply(this);var a=this.manager.store.get("q").val();return a!==t&&this.afterChangeSelection(a),a!==t},afterChangeSelection:function(e){},unclickHandler:function(){var e=this;return function(){return e.clear()&&e.doRequest(),!1}},clickHandler:function(e){var t=this;return function(){return t.set(e)&&t.doRequest(),!1}}})}),jQuery,AjaxSolr.AutocompleteTermWidget=AjaxSolr.AbstractTextWidget.extend({constructor:function(e){AjaxSolr.AutocompleteTermWidget.__super__.constructor.apply(this,arguments),AjaxSolr.extend(this,{field:null,tokenized:!0,lowercase:!0,limit:5,minLength:2,servlet:null},e)},init:function(){if(!this.field)throw'"field" must be set on AutocompleteTermWidget.';this.servlet=this.servlet||this.manager.servlet}}),function(e){AjaxSolr.SearchManager=AjaxSolr.Manager.extend({pageIds:{searchFieldId:"#search-query",searchButtonId:"#search-btn",docs:"#search-result .docs",summarytarget:".search-term",summarypager:"#search-result .pager-summary",suggestiontarget:"#search-result .sugg",searchResult:"#search-result",pager:"#search-result .pager",main:"#main"},searchLabels:{en:{notFound:"<p class='mb-1'>Sorry, no results match your query.</p>",header:"Search results for:",tail:"",disLabel:" Displaying ",toLabel:" to ",ofLabel:" of ",nextLabel:"Next",preLabel:"Prev",ques:"Did you mean ",specChar:"No special characters"},fr:{notFound:"Aucun resultat ne correspond a votre recherche. ",header:"Résultats de recherche pour :",tail:"",disLabel:" Visualisation ",toLabel:" à ",ofLabel:" de ",nextLabel:"Suivant",preLabel:"précédent",ques:"Vouliez-vous dire: ",specChar:"Pas de caractères spéciaux"},es:{notFound:"No documents match the query.",header:"Search results for",tail:"",disLabel:" visualisation ",toLabel:" à ",ofLabel:" de ",nextLabel:"Suivant",preLabel:"précédent",ques:"Did you mean: ",specChar:"No hay caracteres especiales"}},showResultsPanel:function(t){e(this.pageIds.searchResult).show(),e("#content").hide(),e(this.pageIds.main).hide()},clearSearch:function(){e(this.pageIds.searchResult).hide(),e("#content").show(),e(this.pageIds.main).show()},addHistory:function(t,a,r){var n=void 0===window.location.search?window.location.search:"?search",s="#"+e.trim(t).replace(/\s+/g,"-").toLowerCase();r&&(n=n+"&page="+r),console.log(r),window.history.pushState(null,a,n+s)},getParameterByName:function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null},setSearch:function(t,a){var r=this;r.pageIds=t;var n=window.location.hash.replace(/-/g," ").replace(/#/g,""),s=window.location.search.indexOf("search"),i=window.location.search.indexOf("page");if(void 0!==a){var o=a.substring(3,5);if(r.addWidget(new AjaxSolr.ResultWidget({id:"result",target:r.pageIds.docs,header:r.searchLabels[o].header,tail:r.searchLabels[o].tail,notFound:r.searchLabels[o].notFound,ques:r.searchLabels[o].ques,summarytarget:r.pageIds.summarytarget,summarypager:r.pageIds.summarypager,suggestiontarget:r.pageIds.suggestiontarget})),r.addWidget(new AjaxSolr.AutocompleteTermWidget({id:"text",target:r.pageIds.searchFieldId,field:"text"})),r.addWidget(new AjaxSolr.PagerWidget({id:"pager",target:r.pageIds.pager,prevLabel:"<img src='/etc/designs/bns/img/icons/page-previous.svg'/>",nextLabel:"<img src='/etc/designs/bns/img/icons/page-next.svg'/>",innerWindow:1,renderHeader:function(t,a,n){n>0?e(r.pageIds.summarypager).html(e('<span class="norm"></span>').text(r.searchLabels[o].disLabel+Math.min(n,a+1)+r.searchLabels[o].toLabel+Math.min(n,a+t)+r.searchLabels[o].ofLabel+n+".")):e(r.pageIds.summarypager).html(e("<span></span>").text())}})),r.init(),e(r.pageIds.searchFieldId).on("keydown",function(t){if(13==t.which){var a=e(this).val();return r.mainSearch(a),!1}}),e(document).on("keydown",".mav__search input",function(t){if(13==t.which){var a=e(this).val();return r.mainSearch(a),r.closeMenu(),!1}}),e(document).on("click",".mav__search button",function(t){var a=e(".mav__search input").val();return r.mainSearch(a),r.closeMenu(),!1}),e(r.pageIds.searchButtonId).on("click",function(){var t=e(r.pageIds.searchFieldId).val();return r.mainSearch(t),!1}),e(r.pageIds.suggestiontarget).on("click",function(t){if(/^A/i.test(t.target.tagName)){var a=e(t.target).text();r.mainSearch(a)}}),n&&s>-1&&i>-1){var c=r.getParameterByName("page");e(r.pageIds.searchFieldId).val(n),r.mainSearch(n,c)}else n&&s>-1&&(e(r.pageIds.searchFieldId).val(n),r.mainSearch(n));e(window).on("popstate",function(t){var a=window.location.hash.replace(/-/g," ").replace(/#/g,""),n=window.location.search,s=window.location.search.indexOf("page"),i=n.indexOf("search");r.getParameterByName("page");a&&i>-1&&s>-1?(e(r.pageIds.searchFieldId).val(a),r.mainSearch(a)):a&&i>-1?(e(r.pageIds.searchFieldId).val(a),r.mainSearch(a)):r.clearSearch()})}},mainSearch:function(t,a){var r=e("html").attr("lang");if(console.log("mainSearch:"+t),""==t||"Search"==t||"Recherche"==t||t.match(/[`~!#$%^*()_|+\=?;:"<>\{\}\[\]\\\/]/))return t.match(/[`~!#$%^*()_|+\=?;:"<>\{\}\[\]\\\/]/)&&e(this.pageIds.searchFieldId).addClass("input-validation-error"),!1;e(this.pageIds.searchFieldId).removeClass("input-validation-error"),e(this.pageIds.searchFieldId).blur(),e(".ui-menu").hide(),pageName=e(document).find("title").text()+" | "+this.searchLabels[r].header+'"'+t+'"',this.showResultsPanel(t),this.store.addByValue("spellcheck.q",t),this.store.addByValue("hl.q",t),this.store.addByValue("q",t),this.store.addByValue("spellcheck","true"),this.doRequest()},closeMenu:function(){var t=e(".mav"),a=e(".bns--navicon");t.hasClass("in")&&(t.addClass("out"),BNS.onTransitionEnd(t[0],function(){t.removeClass("in"),t.removeClass("active"),a.removeClass("active"),t.removeClass("out")}))}})}(jQuery);